---
layout: home
permalink: /category
---
<style>
	.category-list {
		padding-left: 1em;
	}
	#category-name {
		padding: 5px 0.5em;
		background: var(--dark);
		color: var(--text-light);
		border-radius: 5px;
	}
</style>
<h1>CATEGORY: <span id='category-name'></span></h1>
<div class="category-list">

</div>
<script>
	const path = document.location.pathname.match(/category\/(.*)\/?$/i);
	let cat_name = "";

	if (!path) cat_name = "None";
	else cat_name = path[1];
	
	$('#category-name').text(cat_name);

	document.addEventListener('DOMContentLoaded', async()=>{
		const listDiv = $('.category-list');

		const res = await fetch('/api/postByCat');
		const json = await res.json().catch(err=>{
			console.log(err);
			json = [];
		});
		const data = json;
		if (!data.hasOwnProperty(cat_name)) {
			return;
		}
		
		for (const post of data[cat_name])
		{
			const postDiv = createPostDiv(post);
			listDiv.append(postDiv);
		}
	});

	function createPostDiv(post) {
		return $('<a/>').attr('href', post.url).addClass('home-post row')
		.html(`
			<div class="col-4">
				<div class='home-post-img'>
					<img class='res-img' src='${post.img}'/>
				</div>
			</div>
			<div class='col-8'>
				<div class='home-post-title'>${post.title}</div>
				<div class='home-post-date'>${ new Date(post.date).toLocaleDateString('vi-VN') }</div>
				<div class='home-post-author'>${post.author}</div>
				<div class='home-post-summary'>${post.summary}</div>
			</div>
		`);
	}
</script>
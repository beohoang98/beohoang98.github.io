---
layout: home
permalink: /tag
---
<style>
	.tag-list {
		padding-left: 1em;
	}
	#tag-name {
		padding: 5px 0.5em;
		background: var(--dark);
		color: var(--text-light);
		border-radius: 5px;
	}
</style>
<h1>TAG: <span id='tag-name'></span></h1>
<div class="tag-list">

</div>
<script>
	const path = document.location.pathname.match(/tag\/(.*)\/?$/i);
	let tagname = "";

	if (!path) {
		$('#tag-name').remove();
		tagname = null;
	}
	else {
		tagname = path[1];
		$('#tag-name').text(tagname);
	}

	document.addEventListener('DOMContentLoaded', async()=>{
		const listDiv = $('.tag-list');

		const res = await fetch('/api/postByTag');
		const json = await res.json().catch(err=>{
			console.log(err);
			json = [];
		});
		const data = json;
		if (!data.hasOwnProperty(tagname)) {
			return;
		}
		
		for (const post of data[tagname])
		{
			const postDiv = createPostDiv(post);
			listDiv.append(postDiv);
		}
	});

	function createPostDiv(post) {
		return $('<a/>').attr('href', post.url).addClass('home-post row')
		.html(`
			<div class="col-4">
				<div class='home-post-img'>
					<img class='res-img' src='${post.img}'/>
				</div>
			</div>
			<div class='col-8'>
				<div class='home-post-title'>${post.title}</div>
				<div class='home-post-date'>${ new Date(post.date).toLocaleDateString('vi-VN') }</div>
				<div class='home-post-author'>${post.author}</div>
				<div class='home-post-summary'>${post.summary}</div>
			</div>
		`);
	}
</script>